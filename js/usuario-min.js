function putCustomer(n){localStorage.setItem(STORAGE_CUSTOMER_LOGGED,n)}function getCustomer(){return JSON.parse(localStorage.getItem(STORAGE_CUSTOMER_LOGGED))}function logOffCustomer(){localStorage.removeItem(STORAGE_CUSTOMER_LOGGED);document.location.href=""}function verifyCustomerNav(){let n=getCustomer();n?(document.getElementById("liCustomerNameTopNav").style.display="block",document.getElementById("labelCustomerNameTopNav").innerText=n.nome,document.getElementById("maAccess").style.display="none",document.getElementById("maDataAndOrders").style.display="block",document.getElementById("maExit").style.display="block"):(document.getElementById("liCustomerNameTopNav").style.display="none",document.getElementById("labelCustomerNameTopNav").innerText="",document.getElementById("maAccess").style.display="block",document.getElementById("maDataAndOrders").style.display="none",document.getElementById("maExit").style.display="none")}function verifyUserAdmin(){let n=getCustomer();n?document.getElementById("menu-admin").style.display=n.perfil==ID_PERFIL_ADMIN?"block":"none":logOffCustomer()}function verifyUserPermission(){let n=getCustomer();n?n.perfil!=ID_PERFIL_ADMIN&&(document.location.href=""):document.location.href=""}function login(){let n=$("#input-email").val(),t=$("#input-password").val();return $.ajax({url:"ajax-usuario.php",type:"get",dataType:"json",data:{acao:"login",email:n,senha:t},statusCode:{500:function(){return displayMessage("Erro ao cadastrar novo usuário!","Erro Sistêmico","error",4),!1},401:function(){return displayMessage("Senha incorreta!","Senha inválida","error",4),!1},404:function(){return displayMessage("Usuário não cadastrado com esse email!","Usuário não cadastrado","error",4),!1}}}).done(function(n){return putCustomer(JSON.stringify(n)),document.location.href="",!1}),!1}function createNewUser(){let n=$("#input-fullname").val(),t=$("#input-email").val(),i=$("#input-telephone").val(),r=$("#input-lote").val(),u=$("#input-password").val(),f=$("#input-confirm").val();return u!=f?(displayMessage("As senhas não coincidem!","Senhas informadas","error",4),!1):($.ajax({url:"ajax-usuario.php",type:"get",dataType:"json",data:{acao:"inserir",email:t,celular:i,nome:n,lote:r,senha:u},statusCode:{500:function(){return displayMessage("Erro ao cadastrar novo usuário!","Erro Sistêmico","error",4),!1},409:function(){return displayMessage("Já existe um cadastro para esse email!","Email já cadastrado","warning",4),!1}}}).done(function(u){let f={};return f.id=u.id,f.perfil=0,f.nome=n,f.numeroLote=r,f.email=t,f.celular=i,putCustomer(JSON.stringify(f)),document.location.href="customer-saved",!1}),!1)}function updateCustomerData(){let n=$("#input-fullname").val(),t=$("#input-email").val(),i=$("#input-telephone").val(),r=$("#input-lote").val(),u=getCustomer(),f=u.id,e=u.perfil;return $.ajax({url:"ajax-usuario.php",type:"get",dataType:"json",data:{acao:"update",id:f,email:t,celular:i,nome:n,lote:r},statusCode:{500:function(){return displayMessage("Erro ao atualizar usuário!","Erro Sistêmico","error",4),!1},409:function(){return displayMessage("Já existe um cadastro para esse email!","Email já cadastrado","warning",4),!1}}}).done(function(){localStorage.removeItem(STORAGE_CUSTOMER_LOGGED);let u={};return u.id=f,u.perfil=e,u.nome=n,u.numeroLote=r,u.email=t,u.celular=i,putCustomer(JSON.stringify(u)),document.location.href="account",!1}),!1}function loadCustomerData(){let n=getCustomer();n&&($("#input-fullname").val(n.nome),$("#input-email").val(n.email),$("#input-telephone").val(n.celular),$("#input-lote").val(n.numeroLote))}function passwordRedefinition(){let n=$("#input-password").val(),t=$("#input-confirm").val();if(n!=t)return displayMessage("As senhas não coincidem!","Senhas informadas","error",4),!1;let i=getCustomer();return $.ajax({url:"ajax-usuario.php",type:"get",dataType:"json",data:{acao:"changepwd",id:i.id,novaSenha:n},statusCode:{500:function(){return displayMessage("Erro ao atualizar senha do usuário!","Erro Sistêmico","error",4),!1}}}).done(function(){return document.location.href="account",!1}),!1}function excluirConta(){if(confirm("Deseja realmente excluir seu cadastro?")){let n=getCustomer();n&&$.ajax({url:"ajax-usuario.php",type:"get",dataType:"json",data:{acao:"delete",id:n.id},statusCode:{500:function(){return displayMessage("Erro ao excluir usuário!","Erro Sistêmico","error",4),!1}}}).done(function(){logOffCustomer()})}}function togleCustomerComments(){let n=getCustomer();n?($("#customerCommentLogged").show(),$("#joinToComment").hide(),$("#customerNameComment").val(n.nome)):($("#customerCommentLogged").hide(),$("#joinToComment").show())}function sendComment(n){let t=$("#customerNameComment").val(),i=$("#customerReview").val(),r=$("input[name=rating]:checked").val();if(!t){$("#commentSendAlert").show();$("#commentAlertMessage").text("Informe o nome para o comentário.");return}if(!i){$("#commentSendAlert").show();$("#commentAlertMessage").text("Escreva seu comentário.");return}if(!r){$("#commentSendAlert").show();$("#commentAlertMessage").text("Escolha a sua avaliação.");return}let u=getCustomer();$.ajax({url:"ajax-usuario.php",type:"get",dataType:"json",data:{acao:"coment",id:n,customerId:u.id,author:t,text:i,rating:r}}).done(function(){}).fail(function(){});$("#commentSendAlert").hide();$("#commentSendSuccess").show();$("#customerNameComment").val("");$("#customerReview").val("");$("input[name=rating]").attr("checked",!1);setTimeout(()=>{document.location.reload(!0)},3e3)}function togleUploadPhotos(){let n=getCustomer();n&&(n.perfil==ID_PERFIL_ADMIN?$("#panel-upload-fotos").show():$("#panel-upload-fotos").hide())}const STORAGE_CUSTOMER_LOGGED="usuarioPortalLogado",ID_PERFIL_ADMIN=777;